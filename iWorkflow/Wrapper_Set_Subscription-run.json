{
  "name": "Wrapper_Set_Subscription",
  "description": "Execute a chained workflow that authenticates to an iWorkflow device and set a subscription based on a topic and a REST Worker",
  "globalEnvVars": "./iWF-Subscription-Collection.postman_environment",
  "globalOptions": {
    "insecure": true,
    "reporters": [
      "cli"
    ]
  },
  "globalVars": {
    "bigip_mgmt": "192.168.143.25",
    "bigip_username": "admin",
    "bigip_password": "admin"
  },
  "saveEnvVars": true,
  "outputFile": "Wrapper_Set_Subscription-run.json",
  "envOutputFile": "Wrapper_Set_Subscription-env.json",
  "workflow": [
    {
      "name": "Authenticate to iWorkflow",
      "options": {
        "collection": "./iWF_API_Authentication.postman_collection",
        "environment": {
          "values": [
            {
              "key": "bigip_mgmt",
              "value": "192.168.143.25",
              "type": "text",
              "enabled": true
            },
            {
              "key": "bigip_username",
              "value": "admin",
              "type": "text",
              "enabled": true
            },
            {
              "key": "bigip_password",
              "value": "admin",
              "type": "text",
              "enabled": true
            }
          ]
        },
        "insecure": true,
        "reporters": [
          "cli"
        ],
        "globals": "./iWF-Subscription-Collection.postman_environment"
      },
      "children": [],
      "skip": false,
      "run": {
        "collection": {
          "info": {
            "id": "497ef893-8e71-d349-84e1-ef67690f32c6",
            "name": "iWF_API_Authentication",
            "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
          },
          "event": [],
          "variable": [],
          "item": [
            {
              "id": "fc51287c-5112-420b-8804-ce66e98d2f49",
              "name": "Request a Token from iWorkflow",
              "request": {
                "url": "https://{{iWorkflow_Mgmt_IP}}/mgmt/shared/authn/login",
                "method": "POST",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"username\": {{iwf_username}},\n  \"password\": {{iwf_password}},\n  \"loginProvidername\": \"tmos\"\n}"
                },
                "description": {
                  "content": "Using Basic Auth, request a token from the iWorkflow platform.",
                  "type": "text/plain"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "type": "text/javascript",
                    "exec": [
                      "var respData = JSON.parse(responseBody);",
                      "",
                      "tests[\"response has token: \" +respData.token.token] = respData.token.token;",
                      "",
                      "postman.setEnvironmentVariable('iWorkflow1_Auth_Token',respData.token.token);",
                      ""
                    ]
                  }
                }
              ]
            },
            {
              "id": "76899d0c-3aad-485a-82ec-d4778bb6e226",
              "name": "Increase Auth Token Timeout",
              "request": {
                "url": "https://{{iWorkflow_Mgmt_IP}}/mgmt/shared/authz/tokens/{{iWorkflow1_Auth_Token}}",
                "method": "PATCH",
                "header": [
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "X-F5-Auth-Token",
                    "value": "{{iWorkflow1_Auth_Token}}"
                  },
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"timeout\":\"36000\"\n}"
                },
                "description": {
                  "content": "",
                  "type": "text/plain"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "type": "text/javascript",
                    "exec": [
                      "tests[\"Status code is 200\"] = responseCode.code === 200;",
                      "",
                      "var respData = JSON.parse(responseBody);",
                      "tests[\"Auth Token timeout is: \" +respData.timeout] = respData.timeout;",
                      ""
                    ]
                  }
                }
              ]
            }
          ]
        },
        "environment": {
          "id": "f86f5682-b5ca-4146-aca5-25a5acefe54d",
          "values": [
            {
              "type": "any",
              "value": "192.168.143.25",
              "key": "bigip_mgmt"
            },
            {
              "type": "any",
              "value": "admin",
              "key": "bigip_username"
            },
            {
              "type": "any",
              "value": "admin",
              "key": "bigip_password"
            },
            {
              "type": "any",
              "value": "VVWSQ6NVPDPJQ26EOISWII46KW",
              "key": "iWorkflow1_Auth_Token"
            }
          ]
        },
        "globals": {
          "_": {
            "postman_variable_scope": "environment",
            "postman_exported_at": "2017-03-30T16:06:04.866Z",
            "postman_exported_using": "Postman/4.10.5"
          },
          "id": "b18b50ad-93f5-f564-498f-249de91c6fed",
          "name": "iWF-Subscription-Collection",
          "values": [
            {
              "type": "any",
              "value": "192.168.143.30",
              "key": "iWorkflow_Mgmt_IP"
            },
            {
              "type": "any",
              "value": "admin",
              "key": "iwf_username"
            },
            {
              "type": "any",
              "value": "admin",
              "key": "iwf_password"
            },
            {
              "type": "any",
              "value": "/mgmt/cm/cloud/tenants/Tenant_Nicolas/services/iapp/",
              "key": "subscription_topic"
            },
            {
              "type": "any",
              "value": "http://localhost:8105/shared/ipam-dns-placement-handler",
              "key": "subscriber"
            }
          ]
        },
        "run": {
          "stats": {
            "iterations": {
              "total": 1,
              "pending": 0,
              "failed": 0
            },
            "items": {
              "total": 2,
              "pending": 0,
              "failed": 0
            },
            "scripts": {
              "total": 2,
              "pending": 0,
              "failed": 0
            },
            "prerequests": {
              "total": 2,
              "pending": 0,
              "failed": 0
            },
            "requests": {
              "total": 2,
              "pending": 0,
              "failed": 0
            },
            "tests": {
              "total": 2,
              "pending": 0,
              "failed": 0
            },
            "assertions": {
              "total": 3,
              "pending": 0,
              "failed": 0
            },
            "testScripts": {
              "total": 2,
              "pending": 0,
              "failed": 0
            },
            "prerequestScripts": {
              "total": 0,
              "pending": 0,
              "failed": 0
            }
          },
          "timings": {
            "responseAverage": 80,
            "started": 1490890478600,
            "completed": 1490890478841
          },
          "executions": [
            {
              "cursor": {
                "position": 0,
                "iteration": 0,
                "length": 2,
                "cycles": 1,
                "empty": false,
                "eof": false,
                "bof": true,
                "cr": false,
                "ref": "28b69655-b973-404b-96e4-2423882236e8"
              },
              "item": {
                "id": "fc51287c-5112-420b-8804-ce66e98d2f49",
                "name": "Request a Token from iWorkflow",
                "request": {
                  "url": "https://{{iWorkflow_Mgmt_IP}}/mgmt/shared/authn/login",
                  "method": "POST",
                  "body": {
                    "mode": "raw",
                    "raw": "{\n  \"username\": {{iwf_username}},\n  \"password\": {{iwf_password}},\n  \"loginProvidername\": \"tmos\"\n}"
                  },
                  "description": {
                    "content": "Using Basic Auth, request a token from the iWorkflow platform.",
                    "type": "text/plain"
                  }
                },
                "response": [],
                "event": [
                  {
                    "listen": "test",
                    "script": {
                      "type": "text/javascript",
                      "exec": [
                        "var respData = JSON.parse(responseBody);",
                        "",
                        "tests[\"response has token: \" +respData.token.token] = respData.token.token;",
                        "",
                        "postman.setEnvironmentVariable('iWorkflow1_Auth_Token',respData.token.token);",
                        ""
                      ]
                    }
                  }
                ]
              },
              "request": {
                "url": "https://192.168.143.30/mgmt/shared/authn/login",
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "text/plain"
                  },
                  {
                    "key": "User-Agent",
                    "value": "PostmanRuntime/5.0.0"
                  },
                  {
                    "key": "Accept",
                    "value": "*/*"
                  },
                  {
                    "key": "Host",
                    "value": "192.168.143.30"
                  },
                  {
                    "key": "accept-encoding",
                    "value": "gzip, deflate"
                  },
                  {
                    "key": "content-length",
                    "value": 75
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"username\": admin,\n  \"password\": admin,\n  \"loginProvidername\": \"tmos\"\n}"
                },
                "description": {
                  "content": "Using Basic Auth, request a token from the iWorkflow platform.",
                  "type": "text/plain"
                }
              },
              "response": {
                "id": "ba3533cb-7efc-4168-a002-f871d798bc62",
                "status": "OK",
                "code": 200,
                "header": [
                  {
                    "key": "Server",
                    "value": "webd"
                  },
                  {
                    "key": "Date",
                    "value": "Thu, 30 Mar 2017 16:14:38 GMT"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "Content-Length",
                    "value": "711"
                  },
                  {
                    "key": "Connection",
                    "value": "keep-alive"
                  },
                  {
                    "key": "Pragma",
                    "value": "no-cache"
                  },
                  {
                    "key": "Cache-Control",
                    "value": "no-store, no-cache, must-revalidate"
                  },
                  {
                    "key": "Expires",
                    "value": "-1"
                  },
                  {
                    "key": "X-Real-IP",
                    "value": "192.168.143.1"
                  },
                  {
                    "key": "accept-encoding",
                    "value": "gzip, deflate"
                  }
                ],
                "body": "{\"username\":\"admin\",\"loginReference\":{\"link\":\"https://localhost/mgmt/cm/system/authn/providers/local/login\"},\"loginProviderName\":\"local\",\"token\":{\"token\":\"VVWSQ6NVPDPJQ26EOISWII46KW\",\"name\":\"VVWSQ6NVPDPJQ26EOISWII46KW\",\"userName\":\"admin\",\"authProviderName\":\"local\",\"user\":{\"link\":\"https://localhost/mgmt/shared/authz/users/admin\"},\"groupReferences\":[],\"timeout\":1200,\"startTime\":\"2017-03-30T18:14:38.772+0200\",\"address\":\"192.168.143.1\",\"partition\":\"[All]\",\"generation\":1,\"lastUpdateMicros\":1490890478771918,\"expirationMicros\":1490891678772000,\"kind\":\"shared:authz:tokens:authtokenitemstate\",\"selfLink\":\"https://localhost/mgmt/shared/authz/tokens/VVWSQ6NVPDPJQ26EOISWII46KW\"},\"generation\":0,\"lastUpdateMicros\":0}",
                "cookie": [],
                "responseTime": 146,
                "responseSize": 711,
                "update": {},
                "_postman_requiresId": true,
                "reason": {},
                "text": {},
                "json": {},
                "mime": {},
                "dataURI": {},
                "size": {},
                "encoding": {},
                "describe": {},
                "toObjectResolved": {},
                "forEachParent": {},
                "toJSON": {},
                "meta": {},
                "parent": {}
              },
              "id": "fc51287c-5112-420b-8804-ce66e98d2f49",
              "assertions": [
                {
                  "assertion": "response has token: VVWSQ6NVPDPJQ26EOISWII46KW"
                }
              ]
            },
            {
              "cursor": {
                "ref": "7391251a-205e-48dd-b98e-7fbf5da3063a",
                "length": 2,
                "cycles": 1,
                "position": 1,
                "iteration": 0
              },
              "item": {
                "id": "76899d0c-3aad-485a-82ec-d4778bb6e226",
                "name": "Increase Auth Token Timeout",
                "request": {
                  "url": "https://{{iWorkflow_Mgmt_IP}}/mgmt/shared/authz/tokens/{{iWorkflow1_Auth_Token}}",
                  "method": "PATCH",
                  "header": [
                    {
                      "description": {
                        "content": "",
                        "type": "text/plain"
                      },
                      "key": "X-F5-Auth-Token",
                      "value": "{{iWorkflow1_Auth_Token}}"
                    },
                    {
                      "description": {
                        "content": "",
                        "type": "text/plain"
                      },
                      "key": "Content-Type",
                      "value": "application/json"
                    }
                  ],
                  "body": {
                    "mode": "raw",
                    "raw": "{\n    \"timeout\":\"36000\"\n}"
                  },
                  "description": {
                    "content": "",
                    "type": "text/plain"
                  }
                },
                "response": [],
                "event": [
                  {
                    "listen": "test",
                    "script": {
                      "type": "text/javascript",
                      "exec": [
                        "tests[\"Status code is 200\"] = responseCode.code === 200;",
                        "",
                        "var respData = JSON.parse(responseBody);",
                        "tests[\"Auth Token timeout is: \" +respData.timeout] = respData.timeout;",
                        ""
                      ]
                    }
                  }
                ]
              },
              "request": {
                "url": "https://192.168.143.30/mgmt/shared/authz/tokens/VVWSQ6NVPDPJQ26EOISWII46KW",
                "method": "PATCH",
                "header": [
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "X-F5-Auth-Token",
                    "value": "VVWSQ6NVPDPJQ26EOISWII46KW"
                  },
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "User-Agent",
                    "value": "PostmanRuntime/5.0.0"
                  },
                  {
                    "key": "Accept",
                    "value": "*/*"
                  },
                  {
                    "key": "Host",
                    "value": "192.168.143.30"
                  },
                  {
                    "key": "accept-encoding",
                    "value": "gzip, deflate"
                  },
                  {
                    "key": "content-length",
                    "value": 25
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"timeout\":\"36000\"\n}"
                },
                "description": {
                  "content": "",
                  "type": "text/plain"
                }
              },
              "response": {
                "id": "ee439f05-d71c-4ed7-8ee7-a1cd4ec0f0d1",
                "status": "OK",
                "code": 200,
                "header": [
                  {
                    "key": "Server",
                    "value": "webd"
                  },
                  {
                    "key": "Date",
                    "value": "Thu, 30 Mar 2017 16:14:38 GMT"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "Content-Length",
                    "value": "530"
                  },
                  {
                    "key": "Connection",
                    "value": "keep-alive"
                  },
                  {
                    "key": "Pragma",
                    "value": "no-cache"
                  },
                  {
                    "key": "Cache-Control",
                    "value": "no-store, no-cache, must-revalidate"
                  },
                  {
                    "key": "Expires",
                    "value": "-1"
                  },
                  {
                    "key": "X-Real-IP",
                    "value": "192.168.143.1"
                  },
                  {
                    "key": "accept-encoding",
                    "value": "gzip, deflate"
                  }
                ],
                "body": "{\"token\":\"VVWSQ6NVPDPJQ26EOISWII46KW\",\"name\":\"VVWSQ6NVPDPJQ26EOISWII46KW\",\"userName\":\"admin\",\"authProviderName\":\"local\",\"user\":{\"link\":\"https://localhost/mgmt/shared/authz/users/admin\"},\"groupReferences\":[],\"timeout\":36000,\"startTime\":\"2017-03-30T18:14:38.772+0200\",\"address\":\"192.168.143.1\",\"partition\":\"[All]\",\"generation\":2,\"lastUpdateMicros\":1490890478828046,\"expirationMicros\":1490926478772000,\"kind\":\"shared:authz:tokens:authtokenitemstate\",\"selfLink\":\"https://localhost/mgmt/shared/authz/tokens/VVWSQ6NVPDPJQ26EOISWII46KW\"}",
                "cookie": [],
                "responseTime": 14,
                "responseSize": 530,
                "update": {},
                "_postman_requiresId": true,
                "reason": {},
                "text": {},
                "json": {},
                "mime": {},
                "dataURI": {},
                "size": {},
                "encoding": {},
                "describe": {},
                "toObjectResolved": {},
                "forEachParent": {},
                "toJSON": {},
                "meta": {},
                "parent": {}
              },
              "id": "76899d0c-3aad-485a-82ec-d4778bb6e226",
              "assertions": [
                {
                  "assertion": "Status code is 200"
                },
                {
                  "assertion": "Auth Token timeout is: 36000"
                }
              ]
            }
          ],
          "transfers": {
            "responseTotal": 1241
          },
          "failures": [],
          "error": null
        }
      }
    },
    {
      "name": "Set a subscription",
      "skip": false,
      "options": {
        "collection": "./iWF-Subscription-Collection.postman_collection",
        "environment": {
          "values": [
            {
              "key": "bigip_mgmt",
              "value": "192.168.143.25",
              "type": "text",
              "enabled": true
            },
            {
              "key": "bigip_username",
              "value": "admin",
              "type": "text",
              "enabled": true
            },
            {
              "key": "bigip_password",
              "value": "admin",
              "type": "text",
              "enabled": true
            },
            {
              "type": "any",
              "value": "VVWSQ6NVPDPJQ26EOISWII46KW",
              "key": "iWorkflow1_Auth_Token"
            }
          ]
        },
        "insecure": true,
        "reporters": [
          "cli"
        ],
        "globals": "./iWF-Subscription-Collection.postman_environment"
      },
      "children": [],
      "run": {
        "collection": {
          "info": {
            "id": "7a356500-87e2-8e04-5049-0b0703f61a72",
            "name": "iWF-Subscription-Collection",
            "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
          },
          "event": [],
          "variable": [],
          "item": [
            {
              "id": "f24ec5cc-327c-43b0-8f6f-3d40fcbf904f",
              "name": "create subscription",
              "request": {
                "url": "https://{{iWorkflow_Mgmt_IP}}/mgmt/subscriptions",
                "method": "POST",
                "header": [
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "X-F5-Auth-Token",
                    "value": "{{iWorkflow1_Auth_Token}}"
                  },
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\r\"topic\" : \"{{subscription_topic}}\",\r\"subscriber\": \"{{subscriber}}\"\r}"
                },
                "description": {
                  "content": "create a subscription to monitor the deployment of an iApp. if it happens, the subscription will trigger our handler",
                  "type": "text/plain"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "type": "text/javascript",
                    "exec": [
                      "var respData = JSON.parse(responseBody);",
                      "",
                      "tests[\"response has token: \" +respData.token] = respData.token;",
                      "",
                      "postman.setEnvironmentVariable('Subscription_Token',respData.token);",
                      ""
                    ]
                  }
                }
              ]
            },
            {
              "id": "f3510a7e-56b1-4f46-94dd-af75aa093bc1",
              "name": "Check subscription",
              "request": {
                "url": "https://{{iWorkflow_Mgmt_IP}}/mgmt/subscriptions/{{Subscription_Token}}",
                "method": "GET",
                "header": [
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "X-F5-Auth-Token",
                    "value": "{{iWorkflow1_Auth_Token}}"
                  },
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {},
                "description": {
                  "content": "",
                  "type": "text/plain"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "type": "text/javascript",
                    "exec": [
                      "tests[\"Status code is 200\"] = responseCode.code === 200;"
                    ]
                  }
                }
              ]
            },
            {
              "id": "d056e8d5-b39e-4604-bfe9-3eaed4d9decc",
              "name": "Check subscription on the relevant uri",
              "request": {
                "url": "https://{{iWorkflow_Mgmt_IP}}/mgmt/cm/cloud/tenants/Tenant_Nicolas/services/iapp/subscriptions",
                "method": "GET",
                "header": [
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "X-F5-Auth-Token",
                    "value": "{{iWorkflow1_Auth_Token}}"
                  },
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {},
                "description": {
                  "content": "",
                  "type": "text/plain"
                }
              },
              "response": [],
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "type": "text/javascript",
                    "exec": [
                      "tests[\"Status code is 200\"] = responseCode.code === 200;"
                    ]
                  }
                }
              ]
            }
          ]
        },
        "environment": {
          "id": "15954d13-dba7-4948-ab7c-b391577141a7",
          "values": [
            {
              "type": "any",
              "value": "192.168.143.25",
              "key": "bigip_mgmt"
            },
            {
              "type": "any",
              "value": "admin",
              "key": "bigip_username"
            },
            {
              "type": "any",
              "value": "admin",
              "key": "bigip_password"
            },
            {
              "type": "any",
              "value": "VVWSQ6NVPDPJQ26EOISWII46KW",
              "key": "iWorkflow1_Auth_Token"
            },
            {
              "type": "any",
              "value": "WBVRPFTO4ORAQFFPRTSLMCIXWV",
              "key": "Subscription_Token"
            }
          ]
        },
        "globals": {
          "_": {
            "postman_variable_scope": "environment",
            "postman_exported_at": "2017-03-30T16:06:04.866Z",
            "postman_exported_using": "Postman/4.10.5"
          },
          "id": "b18b50ad-93f5-f564-498f-249de91c6fed",
          "name": "iWF-Subscription-Collection",
          "values": [
            {
              "type": "any",
              "value": "192.168.143.30",
              "key": "iWorkflow_Mgmt_IP"
            },
            {
              "type": "any",
              "value": "admin",
              "key": "iwf_username"
            },
            {
              "type": "any",
              "value": "admin",
              "key": "iwf_password"
            },
            {
              "type": "any",
              "value": "/mgmt/cm/cloud/tenants/Tenant_Nicolas/services/iapp/",
              "key": "subscription_topic"
            },
            {
              "type": "any",
              "value": "http://localhost:8105/shared/ipam-dns-placement-handler",
              "key": "subscriber"
            }
          ]
        },
        "run": {
          "stats": {
            "iterations": {
              "total": 1,
              "pending": 0,
              "failed": 0
            },
            "items": {
              "total": 3,
              "pending": 0,
              "failed": 0
            },
            "scripts": {
              "total": 3,
              "pending": 0,
              "failed": 0
            },
            "prerequests": {
              "total": 3,
              "pending": 0,
              "failed": 0
            },
            "requests": {
              "total": 3,
              "pending": 0,
              "failed": 0
            },
            "tests": {
              "total": 3,
              "pending": 0,
              "failed": 0
            },
            "assertions": {
              "total": 3,
              "pending": 0,
              "failed": 0
            },
            "testScripts": {
              "total": 3,
              "pending": 0,
              "failed": 0
            },
            "prerequestScripts": {
              "total": 0,
              "pending": 0,
              "failed": 0
            }
          },
          "timings": {
            "responseAverage": 5.666666666666667,
            "started": 1490890479123,
            "completed": 1490890479205
          },
          "executions": [
            {
              "cursor": {
                "position": 0,
                "iteration": 0,
                "length": 3,
                "cycles": 1,
                "empty": false,
                "eof": false,
                "bof": true,
                "cr": false,
                "ref": "835c65f7-e46a-4f97-a1fe-b978900e1438"
              },
              "item": {
                "id": "f24ec5cc-327c-43b0-8f6f-3d40fcbf904f",
                "name": "create subscription",
                "request": {
                  "url": "https://{{iWorkflow_Mgmt_IP}}/mgmt/subscriptions",
                  "method": "POST",
                  "header": [
                    {
                      "description": {
                        "content": "",
                        "type": "text/plain"
                      },
                      "key": "X-F5-Auth-Token",
                      "value": "{{iWorkflow1_Auth_Token}}"
                    },
                    {
                      "description": {
                        "content": "",
                        "type": "text/plain"
                      },
                      "key": "Content-Type",
                      "value": "application/json"
                    }
                  ],
                  "body": {
                    "mode": "raw",
                    "raw": "{\r\"topic\" : \"{{subscription_topic}}\",\r\"subscriber\": \"{{subscriber}}\"\r}"
                  },
                  "description": {
                    "content": "create a subscription to monitor the deployment of an iApp. if it happens, the subscription will trigger our handler",
                    "type": "text/plain"
                  }
                },
                "response": [],
                "event": [
                  {
                    "listen": "test",
                    "script": {
                      "type": "text/javascript",
                      "exec": [
                        "var respData = JSON.parse(responseBody);",
                        "",
                        "tests[\"response has token: \" +respData.token] = respData.token;",
                        "",
                        "postman.setEnvironmentVariable('Subscription_Token',respData.token);",
                        ""
                      ]
                    }
                  }
                ]
              },
              "request": {
                "url": "https://192.168.143.30/mgmt/subscriptions",
                "method": "POST",
                "header": [
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "X-F5-Auth-Token",
                    "value": "VVWSQ6NVPDPJQ26EOISWII46KW"
                  },
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "User-Agent",
                    "value": "PostmanRuntime/5.0.0"
                  },
                  {
                    "key": "Accept",
                    "value": "*/*"
                  },
                  {
                    "key": "Host",
                    "value": "192.168.143.30"
                  },
                  {
                    "key": "accept-encoding",
                    "value": "gzip, deflate"
                  },
                  {
                    "key": "content-length",
                    "value": 141
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\r\"topic\" : \"/mgmt/cm/cloud/tenants/Tenant_Nicolas/services/iapp/\",\r\"subscriber\": \"http://localhost:8105/shared/ipam-dns-placement-handler\"\r}"
                },
                "description": {
                  "content": "create a subscription to monitor the deployment of an iApp. if it happens, the subscription will trigger our handler",
                  "type": "text/plain"
                }
              },
              "response": {
                "id": "0844bc99-40c4-44e6-abb2-505767565a9d",
                "status": "OK",
                "code": 200,
                "header": [
                  {
                    "key": "Server",
                    "value": "webd"
                  },
                  {
                    "key": "Date",
                    "value": "Thu, 30 Mar 2017 16:14:39 GMT"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "Content-Length",
                    "value": "376"
                  },
                  {
                    "key": "Connection",
                    "value": "keep-alive"
                  },
                  {
                    "key": "Pragma",
                    "value": "no-cache"
                  },
                  {
                    "key": "Cache-Control",
                    "value": "no-store, no-cache, must-revalidate"
                  },
                  {
                    "key": "Expires",
                    "value": "-1"
                  },
                  {
                    "key": "X-Real-IP",
                    "value": "192.168.143.1"
                  },
                  {
                    "key": "accept-encoding",
                    "value": "gzip, deflate"
                  }
                ],
                "body": "{\"token\":\"WBVRPFTO4ORAQFFPRTSLMCIXWV\",\"topic\":\"/mgmt/cm/cloud/tenants/Tenant_Nicolas/services/iapp/\",\"subscriber\":\"http://localhost:8105/shared/ipam-dns-placement-handler\",\"isPersisted\":false,\"matchDepth\":-1,\"generation\":1,\"lastUpdateMicros\":1490890479148883,\"kind\":\"subscriptions:restsubscription\",\"selfLink\":\"https://localhost/mgmt/subscriptions/WBVRPFTO4ORAQFFPRTSLMCIXWV\"}",
                "cookie": [],
                "responseTime": 5,
                "responseSize": 376,
                "update": {},
                "_postman_requiresId": true,
                "reason": {},
                "text": {},
                "json": {},
                "mime": {},
                "dataURI": {},
                "size": {},
                "encoding": {},
                "describe": {},
                "toObjectResolved": {},
                "forEachParent": {},
                "toJSON": {},
                "meta": {},
                "parent": {}
              },
              "id": "f24ec5cc-327c-43b0-8f6f-3d40fcbf904f",
              "assertions": [
                {
                  "assertion": "response has token: WBVRPFTO4ORAQFFPRTSLMCIXWV"
                }
              ]
            },
            {
              "cursor": {
                "ref": "9147d0e8-e410-455e-a102-1d3e87bdf25d",
                "length": 3,
                "cycles": 1,
                "position": 1,
                "iteration": 0
              },
              "item": {
                "id": "f3510a7e-56b1-4f46-94dd-af75aa093bc1",
                "name": "Check subscription",
                "request": {
                  "url": "https://{{iWorkflow_Mgmt_IP}}/mgmt/subscriptions/{{Subscription_Token}}",
                  "method": "GET",
                  "header": [
                    {
                      "description": {
                        "content": "",
                        "type": "text/plain"
                      },
                      "key": "X-F5-Auth-Token",
                      "value": "{{iWorkflow1_Auth_Token}}"
                    },
                    {
                      "description": {
                        "content": "",
                        "type": "text/plain"
                      },
                      "key": "Content-Type",
                      "value": "application/json"
                    }
                  ],
                  "body": {},
                  "description": {
                    "content": "",
                    "type": "text/plain"
                  }
                },
                "response": [],
                "event": [
                  {
                    "listen": "test",
                    "script": {
                      "type": "text/javascript",
                      "exec": [
                        "tests[\"Status code is 200\"] = responseCode.code === 200;"
                      ]
                    }
                  }
                ]
              },
              "request": {
                "url": "https://192.168.143.30/mgmt/subscriptions/WBVRPFTO4ORAQFFPRTSLMCIXWV",
                "method": "GET",
                "header": [
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "X-F5-Auth-Token",
                    "value": "VVWSQ6NVPDPJQ26EOISWII46KW"
                  },
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "User-Agent",
                    "value": "PostmanRuntime/5.0.0"
                  },
                  {
                    "key": "Accept",
                    "value": "*/*"
                  },
                  {
                    "key": "Host",
                    "value": "192.168.143.30"
                  },
                  {
                    "key": "accept-encoding",
                    "value": "gzip, deflate"
                  }
                ],
                "body": {},
                "description": {
                  "content": "",
                  "type": "text/plain"
                }
              },
              "response": {
                "id": "8d0f6d2b-1cd0-4d12-aa43-8650980c0124",
                "status": "OK",
                "code": 200,
                "header": [
                  {
                    "key": "Server",
                    "value": "webd"
                  },
                  {
                    "key": "Date",
                    "value": "Thu, 30 Mar 2017 16:14:39 GMT"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "Content-Length",
                    "value": "376"
                  },
                  {
                    "key": "Connection",
                    "value": "keep-alive"
                  },
                  {
                    "key": "Pragma",
                    "value": "no-cache"
                  },
                  {
                    "key": "Cache-Control",
                    "value": "no-store, no-cache, must-revalidate"
                  },
                  {
                    "key": "Expires",
                    "value": "-1"
                  },
                  {
                    "key": "X-Real-IP",
                    "value": "192.168.143.1"
                  },
                  {
                    "key": "accept-encoding",
                    "value": "gzip, deflate"
                  }
                ],
                "body": "{\"token\":\"WBVRPFTO4ORAQFFPRTSLMCIXWV\",\"topic\":\"/mgmt/cm/cloud/tenants/Tenant_Nicolas/services/iapp/\",\"subscriber\":\"http://localhost:8105/shared/ipam-dns-placement-handler\",\"isPersisted\":false,\"matchDepth\":-1,\"generation\":1,\"lastUpdateMicros\":1490890479148883,\"kind\":\"subscriptions:restsubscription\",\"selfLink\":\"https://localhost/mgmt/subscriptions/WBVRPFTO4ORAQFFPRTSLMCIXWV\"}",
                "cookie": [],
                "responseTime": 5,
                "responseSize": 376,
                "update": {},
                "_postman_requiresId": true,
                "reason": {},
                "text": {},
                "json": {},
                "mime": {},
                "dataURI": {},
                "size": {},
                "encoding": {},
                "describe": {},
                "toObjectResolved": {},
                "forEachParent": {},
                "toJSON": {},
                "meta": {},
                "parent": {}
              },
              "id": "f3510a7e-56b1-4f46-94dd-af75aa093bc1",
              "assertions": [
                {
                  "assertion": "Status code is 200"
                }
              ]
            },
            {
              "cursor": {
                "ref": "cf1dfd8d-2c88-4a80-bb9b-a764371509c0",
                "length": 3,
                "cycles": 1,
                "position": 2,
                "iteration": 0
              },
              "item": {
                "id": "d056e8d5-b39e-4604-bfe9-3eaed4d9decc",
                "name": "Check subscription on the relevant uri",
                "request": {
                  "url": "https://{{iWorkflow_Mgmt_IP}}/mgmt/cm/cloud/tenants/Tenant_Nicolas/services/iapp/subscriptions",
                  "method": "GET",
                  "header": [
                    {
                      "description": {
                        "content": "",
                        "type": "text/plain"
                      },
                      "key": "X-F5-Auth-Token",
                      "value": "{{iWorkflow1_Auth_Token}}"
                    },
                    {
                      "description": {
                        "content": "",
                        "type": "text/plain"
                      },
                      "key": "Content-Type",
                      "value": "application/json"
                    }
                  ],
                  "body": {},
                  "description": {
                    "content": "",
                    "type": "text/plain"
                  }
                },
                "response": [],
                "event": [
                  {
                    "listen": "test",
                    "script": {
                      "type": "text/javascript",
                      "exec": [
                        "tests[\"Status code is 200\"] = responseCode.code === 200;"
                      ]
                    }
                  }
                ]
              },
              "request": {
                "url": "https://192.168.143.30/mgmt/cm/cloud/tenants/Tenant_Nicolas/services/iapp/subscriptions",
                "method": "GET",
                "header": [
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "X-F5-Auth-Token",
                    "value": "VVWSQ6NVPDPJQ26EOISWII46KW"
                  },
                  {
                    "description": {
                      "content": "",
                      "type": "text/plain"
                    },
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "User-Agent",
                    "value": "PostmanRuntime/5.0.0"
                  },
                  {
                    "key": "Accept",
                    "value": "*/*"
                  },
                  {
                    "key": "Host",
                    "value": "192.168.143.30"
                  },
                  {
                    "key": "accept-encoding",
                    "value": "gzip, deflate"
                  }
                ],
                "body": {},
                "description": {
                  "content": "",
                  "type": "text/plain"
                }
              },
              "response": {
                "id": "2e93bd73-54d6-47f7-ad83-848087434963",
                "status": "OK",
                "code": 200,
                "header": [
                  {
                    "key": "Server",
                    "value": "webd"
                  },
                  {
                    "key": "Date",
                    "value": "Thu, 30 Mar 2017 16:14:39 GMT"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "Content-Length",
                    "value": "163"
                  },
                  {
                    "key": "Connection",
                    "value": "keep-alive"
                  },
                  {
                    "key": "Pragma",
                    "value": "no-cache"
                  },
                  {
                    "key": "Cache-Control",
                    "value": "no-store, no-cache, must-revalidate"
                  },
                  {
                    "key": "Expires",
                    "value": "-1"
                  },
                  {
                    "key": "X-Real-IP",
                    "value": "192.168.143.1"
                  },
                  {
                    "key": "accept-encoding",
                    "value": "gzip, deflate"
                  }
                ],
                "body": "{\"subscribers\":[\"http://localhost:8105/shared/ipam-dns-placement-handler\"],\"failuresPerSubscriber\":{},\"notificationFilters\":{},\"generation\":0,\"lastUpdateMicros\":0}",
                "cookie": [],
                "responseTime": 7,
                "responseSize": 163,
                "update": {},
                "_postman_requiresId": true,
                "reason": {},
                "text": {},
                "json": {},
                "mime": {},
                "dataURI": {},
                "size": {},
                "encoding": {},
                "describe": {},
                "toObjectResolved": {},
                "forEachParent": {},
                "toJSON": {},
                "meta": {},
                "parent": {}
              },
              "id": "d056e8d5-b39e-4604-bfe9-3eaed4d9decc",
              "assertions": [
                {
                  "assertion": "Status code is 200"
                }
              ]
            }
          ],
          "transfers": {
            "responseTotal": 915
          },
          "failures": [],
          "error": null
        }
      }
    }
  ],
  "runId": "Wrapper_Set_Subscription-2017-03-30-16-14-38"
}
